# Модели и Миграции

## Миграции

Еще одно преимущество работы с базой данных через SQLAlchemy — возможность создания миграций для БД. Миграция — это
набор команд, которые изменяют структуру БД, например, добавляют/удаляют таблицу, добавляют/удаляют столбец, изменяют
тип столбца. Давайте взглянем на пример миграции, в которой в базу данных добавляется таблица с названием hotels и
столбцами id, title, задаются их типы, прописываются первичные ключи и так далее.

Здесь sa — это SQLAlchemy, а op — Alembic.

```python
def upgrade() -> None:
    op.create_table(
        "hotels",
        sa.Column("id", sa.Integer(), nullable=False),
        sa.Column("title", sa.String(), nullable=False),
        sa.PrimaryKeyConstraint("id"),
    )
```

Это обычная функция на языке Python. Под капотом эта команда преобразуется в SQL запрос, который будет отправлен в БД.

```sql
CREATE TABLE hotels
(
    id    int PRIMARY KEY,
    title text NOT NULL
);
```

Для того, чтобы изменять состояние БД через Python, используется библиотека Alembic, написанная автором Алхимии.

- Миграции позволяют управлять состоянием БД через Python, не прикасаясь к написанию SQL запросов
- Всегда можно откатиться к нужному состоянию БД, быстро и качественно

#### Для миграций в Python чаще всего используется библиотека Alembic. Таким образом, в данном курсе используются самая
#### популярная связка библиотек для работы с реляционными БД: SQLAlchemy + Alembic.
