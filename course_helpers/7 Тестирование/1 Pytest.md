# Pytest

Тестирование — это одна из часто спрашиваемых тем у начинающих разработчиков. Старшим разработчикам гораздо легче будет
оценить качество вашего кода, если вы написали к нему тесты.
Мы рассмотрим самую популярную библиотеку для тестирования на Python — pytest, которая в последние годы сместила с
первого места встроенную библиотеку `unittest`. Pytest позволяет быстро настроить тестовую среду и удобно писать тесты
через простое использование `assert` в Python. Важно понимать, что единожды написанный тест на pytest затем будет
прогоняться при каждом новом добавлении кода (коммите) в репозиторий (при верной настройке `GitHub/Gitlab`) и будет
экономить вам десятки часов на дебаггинг, не пропуская подобные коммиты, если кто-то вдруг сломает часть кода, который
покрыт вашими тестами.

Давайте поймем, как стоить тестировать приложение, через пирамиду тестирования. Она не привязана к языку Python и тем
более фреймворку FastAPI, она универсальна:

Слово "стоимость" на схеме обозначает количество затраченных нервных клеток и единиц времени на их написание и
поддержку (да, порой тесты приходится переписывать). Единственное, что не указано на этой схеме — порядок написания
тестов. Обычно первыми пишутся unit-тесты, затем API и интеграционные тесты, и лишь затем E2E тесты. Давайте опишем, что
каждый вид тестов:
!["Dbeaver"](/course_helpers/7%20Тестирование/piramid.png)

1. Юнит-тесты тестируют одну единственную функцию в изоляции от других функций. Это значит, что этот тест никоим образом
   не зависит от выполнения других тестов и от внешних систем (баз данных, API'шек, брокеров и т.п.)
2. Интеграционные тесты тестируют 2 и более функций в связке друг с другом. Тем не менее, этот тест также должен быть
   изолирован от всех других тестов
3. API тесты, как понятно из названия, тестируют эндпоинты. Они больше относятся к интеграционным, так как обычно
   содержат в себе несколько функций: получение, обработка и добавление данных, запуск фоновых задач и т.д.
4. E2E (end-to-end) или сквозное тестирование применяется для проверки целых пользовательских сценариев. Например,
   регистрация пользователя -> аутентификация (логин) -> просмотр списка отелей -> просмотр списка номеров в отеле ->
   бронирование номера в отеле -> отправка сообщения на почту с информацией о бронировании. Такие тесты очень долго
   писать и поддерживать